import json
from pathlib import Path
import os
import pytest
from ete3 import Tree
import functools, requests
import fastjsonschema

# following test are performed
# 1. check if output json file passes the schema
# 2. check if all the files found in the json exist
# 3. check randomly selected values from the JSON file
# 4. check if trees (filogram and chronogram) in .nwk files have an expected topology
# 5. verify base65 encoding of CSV file stored in microreact

@functools.lru_cache(maxsize=1)
def _load_schema_validator(schema_arg: str | None):
    if schema_arg is None:
        pytest.skip("No --schema provided; skip schema validation")
    if schema_arg.startswith(("http://", "https://")):
        r = requests.get(schema_arg, timeout=30); r.raise_for_status()
        schema = r.json()
    else:
        schema = json.loads(Path(schema_arg).read_text(encoding="utf-8"))
    return fastjsonschema.compile(schema)

GOLDENS = {
    "test_sars_MN908947.3_filogram.nwk" : "(SARS3_01:0.000165683,(SARS3_07:0.000145298,(SARS3_15:3.37883e-05,SARS3_16:2.5259e-06,(SARS3_10:0,SARS3_17:0,SARS3_18:0)100:2.3619e-06)100:0.000259306)98:0.000533203,(((SARS3_02:2.5259e-06,SARS3_04:3.43302e-05,(SARS3_09:2.5259e-06,SARS3_19:2.5259e-06)97:6.77818e-05,SARS3_06:3.39058e-05,(SARS3_03:0,SARS3_20:0)100:2.5259e-06)98:0.000169284,SARS3_11:0.000136175)100:0.00097618,SARS3_14:0.00238676)100:0.00124936);",
    "test_sars_MN908947.3_chronogram.nwk": "(SARS3_14:2.77687,((SARS3_01:2.49018,(SARS3_07:1.51807,(SARS3_15:0.00178,SARS3_16:0.00178,SARS3_10:0.00178,SARS3_17:0.00178,SARS3_18:0.00178)NODE_0000002:0.04779)NODE_0000001:0.06801)NODE_0000000:0.44558,(SARS3_11:0.16641,(SARS3_02:0.00887,SARS3_04:0.00887,SARS3_06:0.00887,SARS3_03:0.00887,SARS3_20:0.00887,(SARS3_09:0.00156,SARS3_19:0.00156)NODE_0000007:0.00731)NODE_0000006:0.15753)NODE_0000005:1.85977)NODE_0000004:0.03289)NODE_0000003:0.00100;",
    "test_sars_MN908947.3_microreactproject.microreact": "data:application/octet-stream;base64, c3RyYWluCXZpcnVzCWRhdGUJY291bnRyeQljaXR5CXN0YXR1c19BCXR5cGUJbGF0aXR1ZGUJbG9uZ2l0dWRlCXllYXIJbW9udGgJZGF5ClNBUlMzXzAxCXNhcnMtY292LTIJMjAyMy0xMS0yOQlQb2xza2EJQnlkZ29zemN6CUEJc2Fycy1jb3YtMgk1My4xMjE5NjQ4CTE4LjAwMDI1MjkJMjAyMwkxMQkyOQpTQVJTM18wMglzYXJzLWNvdi0yCTIwMjMtMDEtMDEJUG9sc2thCU9wb2xlCUEJc2Fycy1jb3YtMgk1MC42NjY4MTg0CTE3LjkyMzY0MDgJMjAyMwkxCTEKU0FSUzNfMDMJc2Fycy1jb3YtMgkyMDIzLTAxLTAxCU5pZW1jeQlLw7ZsbglBCXNhcnMtY292LTIJNTAuOTM4MzYxCTYuOTU5OTc0CTIwMjMJMQkxClNBUlMzXzA0CXNhcnMtY292LTIJMjAyMy0wMS0wMQlDemVjaHkJUGlsem5vCUIJc2Fycy1jb3YtMgk0OS43NDc3NDE1CTEzLjM3NzUyNDkJMjAyMwkxCTEKU0FSUzNfMDUJc2Fycy1jb3YtMgkyMDIzLTAxLTAxCVBvbHNrYQlLcmFrw7N3CUIJc2Fycy1jb3YtMgk1MC4wNjE5NDc0CTE5LjkzNjg1NjQJMjAyMwkxCTEKU0FSUzNfMDYJc2Fycy1jb3YtMgkyMDIzLTAxLTAxCU5pZW1jeQlCZXJsaW4JQglzYXJzLWNvdi0yCTUyLjUxNzM4ODUJMTMuMzk1MTMwOQkyMDIzCTEJMQpTQVJTM18wNwlzYXJzLWNvdi0yCTIwMjMtMDEtMDMJUG9sc2thCVN6Y3plY2luCUEJc2Fycy1jb3YtMgk1My40MzAxODE4CTE0LjU1MDk2MjMJMjAyMwkxCTMKU0FSUzNfMDgJc2Fycy1jb3YtMgkyMDIzLTAxLTExCUN6ZWNoeQlCcm5vCUIJc2Fycy1jb3YtMgk0OS4xOTIyNDQzCTE2LjYxMTMzODIJMjAyMwkxCTExClNBUlMzXzA5CXNhcnMtY292LTIJMjAyMy0wMS0wMQlDemVjaHkJUGFyZHViaWNlCUEJc2Fycy1jb3YtMgk1MC4wMzg1ODEyCTE1Ljc3OTEzNTYJMjAyMwkxCTEKU0FSUzNfMTAJc2Fycy1jb3YtMgkyMDIxLTA3LTE2CU5pZW1jeQlGcmFua2Z1cnQJQQlzYXJzLWNvdi0yCTUwLjExMDY0NDQJOC42ODIwOTE3CTIwMjEJNwkxNgpTQVJTM18xMQlzYXJzLWNvdi0yCTIwMjMtMDEtMDEJUG9sc2thCcWBw7NkxboJQglzYXJzLWNvdi0yCTUxLjc2ODczMjMJMTkuNDU2OTkxMQkyMDIzCTEJMQpTQVJTM18xMglzYXJzLWNvdi0yCTIwMjMtMDEtMDEJQ3plY2h5CVByYWdhCUEJc2Fycy1jb3YtMgk1MC4wODc0NjU0CTE0LjQyMTI1MzUJMjAyMwkxCTEKU0FSUzNfMTMJc2Fycy1jb3YtMgkyMDI0LTAxLTAxCU5pZW1jeQlIYW1idXJnCUIJc2Fycy1jb3YtMgk1My41NTAzNDEJMTAuMDAwNjU0CTIwMjQJMQkxClNBUlMzXzE0CXNhcnMtY292LTIJMjAyMy0wOS0yMAlQb2xza2EJV3JvY8WCYXcJQQlzYXJzLWNvdi0yCTUxLjEwODk3NzYJMTcuMDMyNjY4OQkyMDIzCTkJMjAKU0FSUzNfMTUJc2Fycy1jb3YtMgkyMDIxLTA3LTE2CVBvbHNrYQlHZGHFhHNrCUEJc2Fycy1jb3YtMgk1NC4zNDgyOTA3CTE4LjY1NDAyMzMJMjAyMQk3CTE2ClNBUlMzXzE2CXNhcnMtY292LTIJMjAyMS0wNy0xNglQb2xza2EJS2F0b3dpY2UJQQlzYXJzLWNvdi0yCTUwLjI1OTg5ODcJMTkuMDIxNTg1MgkyMDIxCTcJMTYKU0FSUzNfMTcJc2Fycy1jb3YtMgkyMDIxLTA3LTE2CU5pZW1jeQlEcmV6bm8JQQlzYXJzLWNvdi0yCTUxLjA0OTMyODYJMTMuNzM4MTQzNwkyMDIxCTcJMTYKU0FSUzNfMTgJc2Fycy1jb3YtMgkyMDIxLTA3LTE2CUN6ZWNoeQlPc3RyYXdhCUEJc2Fycy1jb3YtMgk0OS44MzQ5MTM5CTE4LjI4MjAwODQJMjAyMQk3CTE2ClNBUlMzXzE5CXNhcnMtY292LTIJMjAyMy0wMS0wMQlOaWVtY3kJTW9uYWNoaXVtCUEJc2Fycy1jb3YtMgk0OC4xMzcxMDc5CTExLjU3NTM4MjIJMjAyMwkxCTEKU0FSUzNfMjAJc2Fycy1jb3YtMgkyMDIzLTAxLTAxCVBvbHNrYQlUb3J1xYQJQQlzYXJzLWNvdi0yCTUzLjAxMDI3MjEJMTguNjA0ODA5NAkyMDIzCTEJMQo=",
    'test_sars.json': {
        "output"  : {
            "input_params_data" : {
                "input_ids": [
                "SARS3_01",
                "SARS3_02",
                "SARS3_03",
                "SARS3_04",
                "SARS3_05",
                "SARS3_06",
                "SARS3_07",
                "SARS3_08",
                "SARS3_09",
                "SARS3_10",
                "SARS3_11",
                "SARS3_12",
                "SARS3_13",
                "SARS3_14",
                "SARS3_15",
                "SARS3_16",
                "SARS3_17",
                "SARS3_18",
                "SARS3_19",
                "SARS3_20"
            ],
            "phylogenetic_min_support": 0.75
            },
            "chronogram_data" : {"MN908947.3": {
                "clockrate_correlation": 0.3
            }
            },
            "sequence_filtering_data": {
                "MN908947.3": {
                    "SARS3_01" : {"number_of_N": 126, "number_of_ambiguous": 0, "status": "tak",},
                    "SARS3_03" : {"number_of_N": 307, "number_of_ambiguous": 0, "status": "tak",},
                    "SARS3_05" : {"number_of_N": 23340, "number_of_ambiguous": 0,"status": "nie",},
                    "SARS3_08": {"number_of_N": 121, "number_of_ambiguous": 26,"status": "nie"}
                }
            },
            "sequence_clustering_data": {
                "MN908947.3": {"threshold": 1.0,  "clusters": {"SARS3_03": ["SARS3_03","SARS3_20"],
                                                               "SARS3_02": ["SARS3_02"]
                                                               }
                               }
            },
            "filogram_data": {"MN908947.3": { "id_filogram": ["SARS3_01",
                                                              "SARS3_07",
                                                              "SARS3_10",
                                                              "SARS3_15",
                                                              "SARS3_16",
                                                              "SARS3_02",
                                                              "SARS3_03",
                                                              "SARS3_04",
                                                              "SARS3_09",
                                                              "SARS3_19",
                                                              "SARS3_06",
                                                              "SARS3_11",
                                                              "SARS3_14"],
                                              "program_name": "iqtree2",
                                              "phylogenetic_starting_trees": 10
                                              }
                              }
            }
    },
    "test_influenza_chr1_PB2_chronogram.nwk": "((ESIB_EQA_2025.INFL2.11:2268.59826,ESIB_EQA_2025.INFL2.12:2265.87224)NODE_0000004:252544.99867,(ESIB_EQA_2025.INFL2.06:7060.69403,(ESIB_EQA_2025.INFL2.08:203.71930,ESIB_EQA_2025.INFL2.10:195.92421)NODE_0000003:6863.46348,(ESIB_EQA_2025.INFL2.05:125.56296,(ESIB_EQA_2025.INFL2.02:41.93511,ESIB_EQA_2025.INFL2.03:78.39538,ESIB_EQA_2025.INFL2.04:48.38991)NODE_0000000:50.14275)NODE_0000001:6937.94768)NODE_0000002:247748.71934)NODE_0000005:0.00100;",
    "test_influenza_chr1_PB2_filogram.nwk": "(ESIB_EQA_2025.INFL2.02:0.00192007,ESIB_EQA_2025.INFL2.03:0.00149079,ESIB_EQA_2025.INFL2.04:0.00106711,(ESIB_EQA_2025.INFL2.05:2.8292e-06,((ESIB_EQA_2025.INFL2.08:0.00328586,ESIB_EQA_2025.INFL2.10:0.00495162)98:0.142122,ESIB_EQA_2025.INFL2.06:0.193967,(ESIB_EQA_2025.INFL2.11:0.0335135,ESIB_EQA_2025.INFL2.12:0.0627407)100:10)88:0.119975)92:0.00192225);",
    "test_influenza_chr1_PB2_microreactproject.microreact": "data:application/octet-stream;base64, c3RyYWluCXZpcnVzCWRhdGUJY291bnRyeQljaXR5CXR5cGUJbGF0aXR1ZGUJbG9uZ2l0dWRlCXllYXIJbW9udGgJZGF5CkVTSUJfRVFBXzIwMjUuSU5GTDIuMDEJaW5mbHVlbnphCTIwMDgtMDktMTkJUG9sc2thCUJ5ZGdvc3pjeglIMU4xCTUzLjEyMTk2NDgJMTguMDAwMjUyOQkyMDA4CTkJMTkKRVNJQl9FUUFfMjAyNS5JTkZMMi4wMglpbmZsdWVuemEJMTk4Ny0wNi0xNAlQb2xza2EJT3BvbGUJSDFOMQk1MC42NjY4MTg0CTE3LjkyMzY0MDgJMTk4Nwk2CTE0CkVTSUJfRVFBXzIwMjUuSU5GTDIuMDMJaW5mbHVlbnphCTIwMjMtMTEtMjkJTmllbWN5CUvDtmxuCUgxTjEJNTAuOTM4MzYxCTYuOTU5OTc0CTIwMjMJMTEJMjkKRVNJQl9FUUFfMjAyNS5JTkZMMi4wNAlpbmZsdWVuemEJMTk5My0xMS0yNwlDemVjaHkJUGlsem5vCUgxTjEJNDkuNzQ3NzQxNQkxMy4zNzc1MjQ5CTE5OTMJMTEJMjcKRVNJQl9FUUFfMjAyNS5JTkZMMi4wNQlpbmZsdWVuemEJMjAyMC0xMi0wOAlQb2xza2EJS3Jha8OzdwlIMU4xCTUwLjA2MTk0NzQJMTkuOTM2ODU2NAkyMDIwCTEyCTgKRVNJQl9FUUFfMjAyNS5JTkZMMi4wNglpbmZsdWVuemEJMjAxOC0wMi0xMwlOaWVtY3kJQmVybGluCUgxTjEJNTIuNTE3Mzg4NQkxMy4zOTUxMzA5CTIwMTgJMgkxMwpFU0lCX0VRQV8yMDI1LklORkwyLjA3CWluZmx1ZW56YQkyMDAxLTAzLTAyCVBvbHNrYQlTemN6ZWNpbglIMU4xCTUzLjQzMDE4MTgJMTQuNTUwOTYyMwkyMDAxCTMJMgpFU0lCX0VRQV8yMDI1LklORkwyLjA4CWluZmx1ZW56YQkyMDI0LTA4LTEwCUN6ZWNoeQlCcm5vCUgxTjEJNDkuMTkyMjQ0MwkxNi42MTEzMzgyCTIwMjQJOAkxMApFU0lCX0VRQV8yMDI1LklORkwyLjA5CWluZmx1ZW56YQkyMDEyLTA1LTA2CUN6ZWNoeQlQYXJkdWJpY2UJSDFOMQk1MC4wMzg1ODEyCTE1Ljc3OTEzNTYJMjAxMgk1CTYKRVNJQl9FUUFfMjAyNS5JTkZMMi4xMAlpbmZsdWVuemEJMjAxNi0xMC0yNAlOaWVtY3kJRnJhbmtmdXJ0CUgxTjEJNTAuMTEwNjQ0NAk4LjY4MjA5MTcJMjAxNgkxMAkyNApFU0lCX0VRQV8yMDI1LklORkwyLjExCWluZmx1ZW56YQkyMDIyLTA0LTIxCVBvbHNrYQnFgcOzZMW6CUgxTjEJNTEuNzY4NzMyMwkxOS40NTY5OTExCTIwMjIJNAkyMQpFU0lCX0VRQV8yMDI1LklORkwyLjEyCWluZmx1ZW56YQkyMDE5LTA3LTMwCUN6ZWNoeQlQcmFnYQlIMU4xCTUwLjA4NzQ2NTQJMTQuNDIxMjUzNQkyMDE5CTcJMzAK",
    "test_influenza_chr2_PB1_chronogram.nwk": "((ESIB_EQA_2025.INFL2.11:2371.96101,ESIB_EQA_2025.INFL2.12:2369.23498)NODE_0000003:43430.31324,(ESIB_EQA_2025.INFL2.06:3733.20169,(ESIB_EQA_2025.INFL2.07:684.56210,ESIB_EQA_2025.INFL2.10:700.20919)NODE_0000002:3031.68616,(ESIB_EQA_2025.INFL2.01:93.86802,ESIB_EQA_2025.INFL2.03:109.06177,ESIB_EQA_2025.INFL2.05:106.08660,ESIB_EQA_2025.INFL2.04:79.05629,ESIB_EQA_2025.INFL2.02:72.60149)NODE_0000000:3629.93170)NODE_0000001:42064.88900)NODE_0000004:0.00100;",
    "test_influenza_chr2_PB1_filogram.nwk": "(ESIB_EQA_2025.INFL2.01:0.000853724,ESIB_EQA_2025.INFL2.03:0.000426067,ESIB_EQA_2025.INFL2.05:0.00170981,ESIB_EQA_2025.INFL2.04:0.00256708,ESIB_EQA_2025.INFL2.02:0.00516968,((ESIB_EQA_2025.INFL2.07:0.0156927,ESIB_EQA_2025.INFL2.10:0.00864544)87:0.0400005,ESIB_EQA_2025.INFL2.06:0.17287,(ESIB_EQA_2025.INFL2.11:0.0479389,ESIB_EQA_2025.INFL2.12:0.0473702)100:1.72636)91:0.0654385);",
    "test_influenza_chr2_PB1_microreactproject.microreact": "data:application/octet-stream;base64, c3RyYWluCXZpcnVzCWRhdGUJY291bnRyeQljaXR5CXR5cGUJbGF0aXR1ZGUJbG9uZ2l0dWRlCXllYXIJbW9udGgJZGF5CkVTSUJfRVFBXzIwMjUuSU5GTDIuMDEJaW5mbHVlbnphCTIwMDgtMDktMTkJUG9sc2thCUJ5ZGdvc3pjeglIMU4xCTUzLjEyMTk2NDgJMTguMDAwMjUyOQkyMDA4CTkJMTkKRVNJQl9FUUFfMjAyNS5JTkZMMi4wMglpbmZsdWVuemEJMTk4Ny0wNi0xNAlQb2xza2EJT3BvbGUJSDFOMQk1MC42NjY4MTg0CTE3LjkyMzY0MDgJMTk4Nwk2CTE0CkVTSUJfRVFBXzIwMjUuSU5GTDIuMDMJaW5mbHVlbnphCTIwMjMtMTEtMjkJTmllbWN5CUvDtmxuCUgxTjEJNTAuOTM4MzYxCTYuOTU5OTc0CTIwMjMJMTEJMjkKRVNJQl9FUUFfMjAyNS5JTkZMMi4wNAlpbmZsdWVuemEJMTk5My0xMS0yNwlDemVjaHkJUGlsem5vCUgxTjEJNDkuNzQ3NzQxNQkxMy4zNzc1MjQ5CTE5OTMJMTEJMjcKRVNJQl9FUUFfMjAyNS5JTkZMMi4wNQlpbmZsdWVuemEJMjAyMC0xMi0wOAlQb2xza2EJS3Jha8OzdwlIMU4xCTUwLjA2MTk0NzQJMTkuOTM2ODU2NAkyMDIwCTEyCTgKRVNJQl9FUUFfMjAyNS5JTkZMMi4wNglpbmZsdWVuemEJMjAxOC0wMi0xMwlOaWVtY3kJQmVybGluCUgxTjEJNTIuNTE3Mzg4NQkxMy4zOTUxMzA5CTIwMTgJMgkxMwpFU0lCX0VRQV8yMDI1LklORkwyLjA3CWluZmx1ZW56YQkyMDAxLTAzLTAyCVBvbHNrYQlTemN6ZWNpbglIMU4xCTUzLjQzMDE4MTgJMTQuNTUwOTYyMwkyMDAxCTMJMgpFU0lCX0VRQV8yMDI1LklORkwyLjA4CWluZmx1ZW56YQkyMDI0LTA4LTEwCUN6ZWNoeQlCcm5vCUgxTjEJNDkuMTkyMjQ0MwkxNi42MTEzMzgyCTIwMjQJOAkxMApFU0lCX0VRQV8yMDI1LklORkwyLjA5CWluZmx1ZW56YQkyMDEyLTA1LTA2CUN6ZWNoeQlQYXJkdWJpY2UJSDFOMQk1MC4wMzg1ODEyCTE1Ljc3OTEzNTYJMjAxMgk1CTYKRVNJQl9FUUFfMjAyNS5JTkZMMi4xMAlpbmZsdWVuemEJMjAxNi0xMC0yNAlOaWVtY3kJRnJhbmtmdXJ0CUgxTjEJNTAuMTEwNjQ0NAk4LjY4MjA5MTcJMjAxNgkxMAkyNApFU0lCX0VRQV8yMDI1LklORkwyLjExCWluZmx1ZW56YQkyMDIyLTA0LTIxCVBvbHNrYQnFgcOzZMW6CUgxTjEJNTEuNzY4NzMyMwkxOS40NTY5OTExCTIwMjIJNAkyMQpFU0lCX0VRQV8yMDI1LklORkwyLjEyCWluZmx1ZW56YQkyMDE5LTA3LTMwCUN6ZWNoeQlQcmFnYQlIMU4xCTUwLjA4NzQ2NTQJMTQuNDIxMjUzNQkyMDE5CTcJMzAK",
    "test_influenza_chr3_PA_chronogram.nwk": "((ESIB_EQA_2025.INFL2.11:35.13371,ESIB_EQA_2025.INFL2.12:32.40768)NODE_0000002:69319.25229,(ESIB_EQA_2025.INFL2.06:5279.40496,(ESIB_EQA_2025.INFL2.10:172.42875,(ESIB_EQA_2025.INFL2.07:51.60773,ESIB_EQA_2025.INFL2.08:75.04990)NODE_0000004:105.17393)NODE_0000003:5105.66987,(ESIB_EQA_2025.INFL2.01:86.47891,ESIB_EQA_2025.INFL2.02:65.21238,ESIB_EQA_2025.INFL2.05:98.69749,ESIB_EQA_2025.INFL2.03:101.67266,ESIB_EQA_2025.INFL2.04:71.66718)NODE_0000000:5183.52408)NODE_0000001:64070.79748)NODE_0000005:0.00100;",
    "test_influenza_chr3_PA_filogram.nwk": "(ESIB_EQA_2025.INFL2.01:0.00363201,ESIB_EQA_2025.INFL2.02:0.00135175,ESIB_EQA_2025.INFL2.05:0.000450388,ESIB_EQA_2025.INFL2.03:0.00135488,ESIB_EQA_2025.INFL2.04:0.00180597,(ESIB_EQA_2025.INFL2.06:0.106468,((ESIB_EQA_2025.INFL2.07:0.00181423,ESIB_EQA_2025.INFL2.08:0.00181281)99:0.00395547,ESIB_EQA_2025.INFL2.10:0.00153015)99:0.155171,(ESIB_EQA_2025.INFL2.11:0.0524384,ESIB_EQA_2025.INFL2.12:2.1007e-06)100:2.67806)77:0.0916786);",
    "test_influenza_chr3_PA_microreactproject.microreact": "data:application/octet-stream;base64, c3RyYWluCXZpcnVzCWRhdGUJY291bnRyeQljaXR5CXR5cGUJbGF0aXR1ZGUJbG9uZ2l0dWRlCXllYXIJbW9udGgJZGF5CkVTSUJfRVFBXzIwMjUuSU5GTDIuMDEJaW5mbHVlbnphCTIwMDgtMDktMTkJUG9sc2thCUJ5ZGdvc3pjeglIMU4xCTUzLjEyMTk2NDgJMTguMDAwMjUyOQkyMDA4CTkJMTkKRVNJQl9FUUFfMjAyNS5JTkZMMi4wMglpbmZsdWVuemEJMTk4Ny0wNi0xNAlQb2xza2EJT3BvbGUJSDFOMQk1MC42NjY4MTg0CTE3LjkyMzY0MDgJMTk4Nwk2CTE0CkVTSUJfRVFBXzIwMjUuSU5GTDIuMDMJaW5mbHVlbnphCTIwMjMtMTEtMjkJTmllbWN5CUvDtmxuCUgxTjEJNTAuOTM4MzYxCTYuOTU5OTc0CTIwMjMJMTEJMjkKRVNJQl9FUUFfMjAyNS5JTkZMMi4wNAlpbmZsdWVuemEJMTk5My0xMS0yNwlDemVjaHkJUGlsem5vCUgxTjEJNDkuNzQ3NzQxNQkxMy4zNzc1MjQ5CTE5OTMJMTEJMjcKRVNJQl9FUUFfMjAyNS5JTkZMMi4wNQlpbmZsdWVuemEJMjAyMC0xMi0wOAlQb2xza2EJS3Jha8OzdwlIMU4xCTUwLjA2MTk0NzQJMTkuOTM2ODU2NAkyMDIwCTEyCTgKRVNJQl9FUUFfMjAyNS5JTkZMMi4wNglpbmZsdWVuemEJMjAxOC0wMi0xMwlOaWVtY3kJQmVybGluCUgxTjEJNTIuNTE3Mzg4NQkxMy4zOTUxMzA5CTIwMTgJMgkxMwpFU0lCX0VRQV8yMDI1LklORkwyLjA3CWluZmx1ZW56YQkyMDAxLTAzLTAyCVBvbHNrYQlTemN6ZWNpbglIMU4xCTUzLjQzMDE4MTgJMTQuNTUwOTYyMwkyMDAxCTMJMgpFU0lCX0VRQV8yMDI1LklORkwyLjA4CWluZmx1ZW56YQkyMDI0LTA4LTEwCUN6ZWNoeQlCcm5vCUgxTjEJNDkuMTkyMjQ0MwkxNi42MTEzMzgyCTIwMjQJOAkxMApFU0lCX0VRQV8yMDI1LklORkwyLjA5CWluZmx1ZW56YQkyMDEyLTA1LTA2CUN6ZWNoeQlQYXJkdWJpY2UJSDFOMQk1MC4wMzg1ODEyCTE1Ljc3OTEzNTYJMjAxMgk1CTYKRVNJQl9FUUFfMjAyNS5JTkZMMi4xMAlpbmZsdWVuemEJMjAxNi0xMC0yNAlOaWVtY3kJRnJhbmtmdXJ0CUgxTjEJNTAuMTEwNjQ0NAk4LjY4MjA5MTcJMjAxNgkxMAkyNApFU0lCX0VRQV8yMDI1LklORkwyLjExCWluZmx1ZW56YQkyMDIyLTA0LTIxCVBvbHNrYQnFgcOzZMW6CUgxTjEJNTEuNzY4NzMyMwkxOS40NTY5OTExCTIwMjIJNAkyMQpFU0lCX0VRQV8yMDI1LklORkwyLjEyCWluZmx1ZW56YQkyMDE5LTA3LTMwCUN6ZWNoeQlQcmFnYQlIMU4xCTUwLjA4NzQ2NTQJMTQuNDIxMjUzNQkyMDE5CTcJMzAK",
    "test_influenza_chr4_HA_chronogram.nwk": "((ESIB_EQA_2025.INFL2.11:1227.05438,ESIB_EQA_2025.INFL2.12:1224.32835)NODE_0000003:53797.62432,((ESIB_EQA_2025.INFL2.08:390.95505,ESIB_EQA_2025.INFL2.10:383.15997,(ESIB_EQA_2025.INFL2.07:189.87751,ESIB_EQA_2025.INFL2.09:201.05739)NODE_0000005:177.63537)NODE_0000004:30988.89165,(ESIB_EQA_2025.INFL2.06:11779.90854,(ESIB_EQA_2025.INFL2.02:230.83568,ESIB_EQA_2025.INFL2.05:264.32079,ESIB_EQA_2025.INFL2.03:267.29595,ESIB_EQA_2025.INFL2.04:237.29047)NODE_0000000:11518.40437)NODE_0000001:19593.44942)NODE_0000002:23647.13719)NODE_0000006:0.00100;",
    "test_influenza_chr4_HA_filogram.nwk": "(ESIB_EQA_2025.INFL2.02:0.00523068,ESIB_EQA_2025.INFL2.05:0.00466331,ESIB_EQA_2025.INFL2.03:0.00625817,ESIB_EQA_2025.INFL2.04:0.00567933,(ESIB_EQA_2025.INFL2.06:0.207578,(((ESIB_EQA_2025.INFL2.07:0.00232912,ESIB_EQA_2025.INFL2.09:0.00350229)98:0.00112775,ESIB_EQA_2025.INFL2.08:0.00235742,ESIB_EQA_2025.INFL2.10:0.0208766)100:0.88157,(ESIB_EQA_2025.INFL2.11:0.12794,ESIB_EQA_2025.INFL2.12:0.00742889)100:1.58069)96:0.358181)100:0.24496);",
    "test_influenza_chr4_HA_microreactproject.microreact": "data:application/octet-stream;base64, c3RyYWluCXZpcnVzCWRhdGUJY291bnRyeQljaXR5CXR5cGUJbGF0aXR1ZGUJbG9uZ2l0dWRlCXllYXIJbW9udGgJZGF5CkVTSUJfRVFBXzIwMjUuSU5GTDIuMDEJaW5mbHVlbnphCTIwMDgtMDktMTkJUG9sc2thCUJ5ZGdvc3pjeglIMU4xCTUzLjEyMTk2NDgJMTguMDAwMjUyOQkyMDA4CTkJMTkKRVNJQl9FUUFfMjAyNS5JTkZMMi4wMglpbmZsdWVuemEJMTk4Ny0wNi0xNAlQb2xza2EJT3BvbGUJSDFOMQk1MC42NjY4MTg0CTE3LjkyMzY0MDgJMTk4Nwk2CTE0CkVTSUJfRVFBXzIwMjUuSU5GTDIuMDMJaW5mbHVlbnphCTIwMjMtMTEtMjkJTmllbWN5CUvDtmxuCUgxTjEJNTAuOTM4MzYxCTYuOTU5OTc0CTIwMjMJMTEJMjkKRVNJQl9FUUFfMjAyNS5JTkZMMi4wNAlpbmZsdWVuemEJMTk5My0xMS0yNwlDemVjaHkJUGlsem5vCUgxTjEJNDkuNzQ3NzQxNQkxMy4zNzc1MjQ5CTE5OTMJMTEJMjcKRVNJQl9FUUFfMjAyNS5JTkZMMi4wNQlpbmZsdWVuemEJMjAyMC0xMi0wOAlQb2xza2EJS3Jha8OzdwlIMU4xCTUwLjA2MTk0NzQJMTkuOTM2ODU2NAkyMDIwCTEyCTgKRVNJQl9FUUFfMjAyNS5JTkZMMi4wNglpbmZsdWVuemEJMjAxOC0wMi0xMwlOaWVtY3kJQmVybGluCUgxTjEJNTIuNTE3Mzg4NQkxMy4zOTUxMzA5CTIwMTgJMgkxMwpFU0lCX0VRQV8yMDI1LklORkwyLjA3CWluZmx1ZW56YQkyMDAxLTAzLTAyCVBvbHNrYQlTemN6ZWNpbglIMU4xCTUzLjQzMDE4MTgJMTQuNTUwOTYyMwkyMDAxCTMJMgpFU0lCX0VRQV8yMDI1LklORkwyLjA4CWluZmx1ZW56YQkyMDI0LTA4LTEwCUN6ZWNoeQlCcm5vCUgxTjEJNDkuMTkyMjQ0MwkxNi42MTEzMzgyCTIwMjQJOAkxMApFU0lCX0VRQV8yMDI1LklORkwyLjA5CWluZmx1ZW56YQkyMDEyLTA1LTA2CUN6ZWNoeQlQYXJkdWJpY2UJSDFOMQk1MC4wMzg1ODEyCTE1Ljc3OTEzNTYJMjAxMgk1CTYKRVNJQl9FUUFfMjAyNS5JTkZMMi4xMAlpbmZsdWVuemEJMjAxNi0xMC0yNAlOaWVtY3kJRnJhbmtmdXJ0CUgxTjEJNTAuMTEwNjQ0NAk4LjY4MjA5MTcJMjAxNgkxMAkyNApFU0lCX0VRQV8yMDI1LklORkwyLjExCWluZmx1ZW56YQkyMDIyLTA0LTIxCVBvbHNrYQnFgcOzZMW6CUgxTjEJNTEuNzY4NzMyMwkxOS40NTY5OTExCTIwMjIJNAkyMQpFU0lCX0VRQV8yMDI1LklORkwyLjEyCWluZmx1ZW56YQkyMDE5LTA3LTMwCUN6ZWNoeQlQcmFnYQlIMU4xCTUwLjA4NzQ2NTQJMTQuNDIxMjUzNQkyMDE5CTcJMzAK",
    "test_influenza_chr5_NP_chronogram.nwk": "((ESIB_EQA_2025.INFL2.11:690.92124,ESIB_EQA_2025.INFL2.12:688.19521)NODE_0000002:93777.73737,(ESIB_EQA_2025.INFL2.06:6302.62370,(ESIB_EQA_2025.INFL2.10:229.10894,(ESIB_EQA_2025.INFL2.07:43.51860,ESIB_EQA_2025.INFL2.08:66.96077,ESIB_EQA_2025.INFL2.09:54.69847)NODE_0000004:169.94326)NODE_0000003:6072.20842,(ESIB_EQA_2025.INFL2.01:51.16247,ESIB_EQA_2025.INFL2.03:66.35622,ESIB_EQA_2025.INFL2.04:36.35074,ESIB_EQA_2025.INFL2.02:29.89595,ESIB_EQA_2025.INFL2.05:63.38105)NODE_0000000:6242.05926)NODE_0000001:88161.85135)NODE_0000005:0.00100;",
    "test_influenza_chr5_NP_filogram.nwk": "(ESIB_EQA_2025.INFL2.01:0.00197055,ESIB_EQA_2025.INFL2.03:0.000654381,ESIB_EQA_2025.INFL2.04:2.5259e-06,ESIB_EQA_2025.INFL2.02:0.00131311,ESIB_EQA_2025.INFL2.05:0.00329082,(ESIB_EQA_2025.INFL2.06:0.126881,((ESIB_EQA_2025.INFL2.07:0.000652779,ESIB_EQA_2025.INFL2.08:0.000652805,ESIB_EQA_2025.INFL2.09:0.00327808)97:0.0045797,ESIB_EQA_2025.INFL2.10:0.00399093)98:0.162452,(ESIB_EQA_2025.INFL2.11:2.5259e-06,ESIB_EQA_2025.INFL2.12:0.027525)100:3.71743)100:0.127557);",
    "test_influenza_chr5_NP_microreactproject.microreact": "data:application/octet-stream;base64, c3RyYWluCXZpcnVzCWRhdGUJY291bnRyeQljaXR5CXR5cGUJbGF0aXR1ZGUJbG9uZ2l0dWRlCXllYXIJbW9udGgJZGF5CkVTSUJfRVFBXzIwMjUuSU5GTDIuMDEJaW5mbHVlbnphCTIwMDgtMDktMTkJUG9sc2thCUJ5ZGdvc3pjeglIMU4xCTUzLjEyMTk2NDgJMTguMDAwMjUyOQkyMDA4CTkJMTkKRVNJQl9FUUFfMjAyNS5JTkZMMi4wMglpbmZsdWVuemEJMTk4Ny0wNi0xNAlQb2xza2EJT3BvbGUJSDFOMQk1MC42NjY4MTg0CTE3LjkyMzY0MDgJMTk4Nwk2CTE0CkVTSUJfRVFBXzIwMjUuSU5GTDIuMDMJaW5mbHVlbnphCTIwMjMtMTEtMjkJTmllbWN5CUvDtmxuCUgxTjEJNTAuOTM4MzYxCTYuOTU5OTc0CTIwMjMJMTEJMjkKRVNJQl9FUUFfMjAyNS5JTkZMMi4wNAlpbmZsdWVuemEJMTk5My0xMS0yNwlDemVjaHkJUGlsem5vCUgxTjEJNDkuNzQ3NzQxNQkxMy4zNzc1MjQ5CTE5OTMJMTEJMjcKRVNJQl9FUUFfMjAyNS5JTkZMMi4wNQlpbmZsdWVuemEJMjAyMC0xMi0wOAlQb2xza2EJS3Jha8OzdwlIMU4xCTUwLjA2MTk0NzQJMTkuOTM2ODU2NAkyMDIwCTEyCTgKRVNJQl9FUUFfMjAyNS5JTkZMMi4wNglpbmZsdWVuemEJMjAxOC0wMi0xMwlOaWVtY3kJQmVybGluCUgxTjEJNTIuNTE3Mzg4NQkxMy4zOTUxMzA5CTIwMTgJMgkxMwpFU0lCX0VRQV8yMDI1LklORkwyLjA3CWluZmx1ZW56YQkyMDAxLTAzLTAyCVBvbHNrYQlTemN6ZWNpbglIMU4xCTUzLjQzMDE4MTgJMTQuNTUwOTYyMwkyMDAxCTMJMgpFU0lCX0VRQV8yMDI1LklORkwyLjA4CWluZmx1ZW56YQkyMDI0LTA4LTEwCUN6ZWNoeQlCcm5vCUgxTjEJNDkuMTkyMjQ0MwkxNi42MTEzMzgyCTIwMjQJOAkxMApFU0lCX0VRQV8yMDI1LklORkwyLjA5CWluZmx1ZW56YQkyMDEyLTA1LTA2CUN6ZWNoeQlQYXJkdWJpY2UJSDFOMQk1MC4wMzg1ODEyCTE1Ljc3OTEzNTYJMjAxMgk1CTYKRVNJQl9FUUFfMjAyNS5JTkZMMi4xMAlpbmZsdWVuemEJMjAxNi0xMC0yNAlOaWVtY3kJRnJhbmtmdXJ0CUgxTjEJNTAuMTEwNjQ0NAk4LjY4MjA5MTcJMjAxNgkxMAkyNApFU0lCX0VRQV8yMDI1LklORkwyLjExCWluZmx1ZW56YQkyMDIyLTA0LTIxCVBvbHNrYQnFgcOzZMW6CUgxTjEJNTEuNzY4NzMyMwkxOS40NTY5OTExCTIwMjIJNAkyMQpFU0lCX0VRQV8yMDI1LklORkwyLjEyCWluZmx1ZW56YQkyMDE5LTA3LTMwCUN6ZWNoeQlQcmFnYQlIMU4xCTUwLjA4NzQ2NTQJMTQuNDIxMjUzNQkyMDE5CTcJMzAK",
    "test_influenza_chr6_NA_chronogram.nwk": "((ESIB_EQA_2025.INFL2.11:36.45304,ESIB_EQA_2025.INFL2.12:33.72701)NODE_0000003:44961.50493,((ESIB_EQA_2025.INFL2.05:125.56047,(ESIB_EQA_2025.INFL2.01:77.28214,ESIB_EQA_2025.INFL2.03:92.47589,ESIB_EQA_2025.INFL2.04:62.47041,ESIB_EQA_2025.INFL2.02:56.01561)NODE_0000000:36.05974)NODE_0000001:30252.61016,(ESIB_EQA_2025.INFL2.06:5681.68306,(ESIB_EQA_2025.INFL2.10:284.05947,(ESIB_EQA_2025.INFL2.07:70.65233,ESIB_EQA_2025.INFL2.08:94.09450,ESIB_EQA_2025.INFL2.09:81.83221)NODE_0000006:197.76005)NODE_0000005:5396.31725)NODE_0000004:24693.67095)NODE_0000002:14618.42040)NODE_0000007:0.00100;",
    "test_influenza_chr6_NA_filogram.nwk": "(ESIB_EQA_2025.INFL2.01:0.00420674,ESIB_EQA_2025.INFL2.03:2.5259e-06,(ESIB_EQA_2025.INFL2.05:2.5259e-06,((ESIB_EQA_2025.INFL2.06:0.103381,((ESIB_EQA_2025.INFL2.07:0.00137886,ESIB_EQA_2025.INFL2.08:0.00275895,ESIB_EQA_2025.INFL2.09:0.00345452)79:0.00565622,ESIB_EQA_2025.INFL2.10:0.00407704)100:0.129594)100:0.562333,(ESIB_EQA_2025.INFL2.11:2.5259e-06,ESIB_EQA_2025.INFL2.12:0.0650764)100:1.17935)100:0.595531)84:0.00139439,ESIB_EQA_2025.INFL2.04:0.00349646,ESIB_EQA_2025.INFL2.02:0.00419931);",
    "test_influenza_chr6_NA_microreactproject.microreact": "data:application/octet-stream;base64, c3RyYWluCXZpcnVzCWRhdGUJY291bnRyeQljaXR5CXR5cGUJbGF0aXR1ZGUJbG9uZ2l0dWRlCXllYXIJbW9udGgJZGF5CkVTSUJfRVFBXzIwMjUuSU5GTDIuMDEJaW5mbHVlbnphCTIwMDgtMDktMTkJUG9sc2thCUJ5ZGdvc3pjeglIMU4xCTUzLjEyMTk2NDgJMTguMDAwMjUyOQkyMDA4CTkJMTkKRVNJQl9FUUFfMjAyNS5JTkZMMi4wMglpbmZsdWVuemEJMTk4Ny0wNi0xNAlQb2xza2EJT3BvbGUJSDFOMQk1MC42NjY4MTg0CTE3LjkyMzY0MDgJMTk4Nwk2CTE0CkVTSUJfRVFBXzIwMjUuSU5GTDIuMDMJaW5mbHVlbnphCTIwMjMtMTEtMjkJTmllbWN5CUvDtmxuCUgxTjEJNTAuOTM4MzYxCTYuOTU5OTc0CTIwMjMJMTEJMjkKRVNJQl9FUUFfMjAyNS5JTkZMMi4wNAlpbmZsdWVuemEJMTk5My0xMS0yNwlDemVjaHkJUGlsem5vCUgxTjEJNDkuNzQ3NzQxNQkxMy4zNzc1MjQ5CTE5OTMJMTEJMjcKRVNJQl9FUUFfMjAyNS5JTkZMMi4wNQlpbmZsdWVuemEJMjAyMC0xMi0wOAlQb2xza2EJS3Jha8OzdwlIMU4xCTUwLjA2MTk0NzQJMTkuOTM2ODU2NAkyMDIwCTEyCTgKRVNJQl9FUUFfMjAyNS5JTkZMMi4wNglpbmZsdWVuemEJMjAxOC0wMi0xMwlOaWVtY3kJQmVybGluCUgxTjEJNTIuNTE3Mzg4NQkxMy4zOTUxMzA5CTIwMTgJMgkxMwpFU0lCX0VRQV8yMDI1LklORkwyLjA3CWluZmx1ZW56YQkyMDAxLTAzLTAyCVBvbHNrYQlTemN6ZWNpbglIMU4xCTUzLjQzMDE4MTgJMTQuNTUwOTYyMwkyMDAxCTMJMgpFU0lCX0VRQV8yMDI1LklORkwyLjA4CWluZmx1ZW56YQkyMDI0LTA4LTEwCUN6ZWNoeQlCcm5vCUgxTjEJNDkuMTkyMjQ0MwkxNi42MTEzMzgyCTIwMjQJOAkxMApFU0lCX0VRQV8yMDI1LklORkwyLjA5CWluZmx1ZW56YQkyMDEyLTA1LTA2CUN6ZWNoeQlQYXJkdWJpY2UJSDFOMQk1MC4wMzg1ODEyCTE1Ljc3OTEzNTYJMjAxMgk1CTYKRVNJQl9FUUFfMjAyNS5JTkZMMi4xMAlpbmZsdWVuemEJMjAxNi0xMC0yNAlOaWVtY3kJRnJhbmtmdXJ0CUgxTjEJNTAuMTEwNjQ0NAk4LjY4MjA5MTcJMjAxNgkxMAkyNApFU0lCX0VRQV8yMDI1LklORkwyLjExCWluZmx1ZW56YQkyMDIyLTA0LTIxCVBvbHNrYQnFgcOzZMW6CUgxTjEJNTEuNzY4NzMyMwkxOS40NTY5OTExCTIwMjIJNAkyMQpFU0lCX0VRQV8yMDI1LklORkwyLjEyCWluZmx1ZW56YQkyMDE5LTA3LTMwCUN6ZWNoeQlQcmFnYQlIMU4xCTUwLjA4NzQ2NTQJMTQuNDIxMjUzNQkyMDE5CTcJMzAK",
    "test_influenza_chr7_MP_chronogram.nwk": "((ESIB_EQA_2025.INFL2.11:43.11201,ESIB_EQA_2025.INFL2.12:40.38598)NODE_0000002:95588.16577,(ESIB_EQA_2025.INFL2.06:2359.45828,(ESIB_EQA_2025.INFL2.10:100.88383,(ESIB_EQA_2025.INFL2.09:33.11782,ESIB_EQA_2025.INFL2.07:21.93795,ESIB_EQA_2025.INFL2.08:45.38012)NODE_0000004:63.29880)NODE_0000003:2257.26811,(ESIB_EQA_2025.INFL2.01:29.03411,ESIB_EQA_2025.INFL2.04:14.22237,ESIB_EQA_2025.INFL2.05:41.25269,ESIB_EQA_2025.INFL2.02:7.76758,ESIB_EQA_2025.INFL2.03:44.22785)NODE_0000000:2321.02221)NODE_0000001:93267.63594)NODE_0000005:0.00100;",
    "test_influenza_chr7_MP_filogram.nwk": "(ESIB_EQA_2025.INFL2.01:0.000996815,ESIB_EQA_2025.INFL2.04:2.5259e-06,ESIB_EQA_2025.INFL2.05:0.000997036,ESIB_EQA_2025.INFL2.02:0.00199655,ESIB_EQA_2025.INFL2.03:0.000997132,(ESIB_EQA_2025.INFL2.06:0.0327249,(((ESIB_EQA_2025.INFL2.07:2.5259e-06,ESIB_EQA_2025.INFL2.08:0.000999372)83:2.5259e-06,ESIB_EQA_2025.INFL2.09:0.00400819)80:0.00218778,ESIB_EQA_2025.INFL2.10:0.00181691)79:0.143476,(ESIB_EQA_2025.INFL2.11:0.000225662,ESIB_EQA_2025.INFL2.12:0.0527556)100:3.99333)88:0.0515056);",
    "test_influenza_chr7_MP_microreactproject.microreact": "data:application/octet-stream;base64, c3RyYWluCXZpcnVzCWRhdGUJY291bnRyeQljaXR5CXR5cGUJbGF0aXR1ZGUJbG9uZ2l0dWRlCXllYXIJbW9udGgJZGF5CkVTSUJfRVFBXzIwMjUuSU5GTDIuMDEJaW5mbHVlbnphCTIwMDgtMDktMTkJUG9sc2thCUJ5ZGdvc3pjeglIMU4xCTUzLjEyMTk2NDgJMTguMDAwMjUyOQkyMDA4CTkJMTkKRVNJQl9FUUFfMjAyNS5JTkZMMi4wMglpbmZsdWVuemEJMTk4Ny0wNi0xNAlQb2xza2EJT3BvbGUJSDFOMQk1MC42NjY4MTg0CTE3LjkyMzY0MDgJMTk4Nwk2CTE0CkVTSUJfRVFBXzIwMjUuSU5GTDIuMDMJaW5mbHVlbnphCTIwMjMtMTEtMjkJTmllbWN5CUvDtmxuCUgxTjEJNTAuOTM4MzYxCTYuOTU5OTc0CTIwMjMJMTEJMjkKRVNJQl9FUUFfMjAyNS5JTkZMMi4wNAlpbmZsdWVuemEJMTk5My0xMS0yNwlDemVjaHkJUGlsem5vCUgxTjEJNDkuNzQ3NzQxNQkxMy4zNzc1MjQ5CTE5OTMJMTEJMjcKRVNJQl9FUUFfMjAyNS5JTkZMMi4wNQlpbmZsdWVuemEJMjAyMC0xMi0wOAlQb2xza2EJS3Jha8OzdwlIMU4xCTUwLjA2MTk0NzQJMTkuOTM2ODU2NAkyMDIwCTEyCTgKRVNJQl9FUUFfMjAyNS5JTkZMMi4wNglpbmZsdWVuemEJMjAxOC0wMi0xMwlOaWVtY3kJQmVybGluCUgxTjEJNTIuNTE3Mzg4NQkxMy4zOTUxMzA5CTIwMTgJMgkxMwpFU0lCX0VRQV8yMDI1LklORkwyLjA3CWluZmx1ZW56YQkyMDAxLTAzLTAyCVBvbHNrYQlTemN6ZWNpbglIMU4xCTUzLjQzMDE4MTgJMTQuNTUwOTYyMwkyMDAxCTMJMgpFU0lCX0VRQV8yMDI1LklORkwyLjA4CWluZmx1ZW56YQkyMDI0LTA4LTEwCUN6ZWNoeQlCcm5vCUgxTjEJNDkuMTkyMjQ0MwkxNi42MTEzMzgyCTIwMjQJOAkxMApFU0lCX0VRQV8yMDI1LklORkwyLjA5CWluZmx1ZW56YQkyMDEyLTA1LTA2CUN6ZWNoeQlQYXJkdWJpY2UJSDFOMQk1MC4wMzg1ODEyCTE1Ljc3OTEzNTYJMjAxMgk1CTYKRVNJQl9FUUFfMjAyNS5JTkZMMi4xMAlpbmZsdWVuemEJMjAxNi0xMC0yNAlOaWVtY3kJRnJhbmtmdXJ0CUgxTjEJNTAuMTEwNjQ0NAk4LjY4MjA5MTcJMjAxNgkxMAkyNApFU0lCX0VRQV8yMDI1LklORkwyLjExCWluZmx1ZW56YQkyMDIyLTA0LTIxCVBvbHNrYQnFgcOzZMW6CUgxTjEJNTEuNzY4NzMyMwkxOS40NTY5OTExCTIwMjIJNAkyMQpFU0lCX0VRQV8yMDI1LklORkwyLjEyCWluZmx1ZW56YQkyMDE5LTA3LTMwCUN6ZWNoeQlQcmFnYQlIMU4xCTUwLjA4NzQ2NTQJMTQuNDIxMjUzNQkyMDE5CTcJMzAK",
    "test_influenza_chr8_NS_chronogram.nwk": "((ESIB_EQA_2025.INFL2.11:1062.97841,ESIB_EQA_2025.INFL2.12:1060.25238)NODE_0000002:64788.21940,((ESIB_EQA_2025.INFL2.01:104.75932,ESIB_EQA_2025.INFL2.05:116.97790,ESIB_EQA_2025.INFL2.04:89.94758,ESIB_EQA_2025.INFL2.02:83.49279,ESIB_EQA_2025.INFL2.03:119.95306)NODE_0000000:5353.05142,(ESIB_EQA_2025.INFL2.06:3662.22753,(ESIB_EQA_2025.INFL2.10:111.87584,(ESIB_EQA_2025.INFL2.07:27.38331,ESIB_EQA_2025.INFL2.08:50.82548,ESIB_EQA_2025.INFL2.09:38.56318)NODE_0000005:68.84544)NODE_0000004:3549.04535)NODE_0000003:1804.98517)NODE_0000001:60379.80155)NODE_0000006:0.00100;",
    "test_influenza_chr8_NS_filogram.nwk": "(ESIB_EQA_2025.INFL2.01:0.0023129,ESIB_EQA_2025.INFL2.05:0.00115458,ESIB_EQA_2025.INFL2.04:0.00231402,ESIB_EQA_2025.INFL2.02:0.00115492,ESIB_EQA_2025.INFL2.03:0.00347258,((ESIB_EQA_2025.INFL2.06:0.113587,((ESIB_EQA_2025.INFL2.07:2.5259e-06,ESIB_EQA_2025.INFL2.08:0.00230354,ESIB_EQA_2025.INFL2.09:0.00230674)98:0.00283402,ESIB_EQA_2025.INFL2.10:0.00412837)96:0.107913)80:0.0972255,(ESIB_EQA_2025.INFL2.11:0.00991768,ESIB_EQA_2025.INFL2.12:0.0328846)100:2.53896)94:0.067043);",
    "test_influenza_chr8_NS_microreactproject.microreact": "data:application/octet-stream;base64, c3RyYWluCXZpcnVzCWRhdGUJY291bnRyeQljaXR5CXR5cGUJbGF0aXR1ZGUJbG9uZ2l0dWRlCXllYXIJbW9udGgJZGF5CkVTSUJfRVFBXzIwMjUuSU5GTDIuMDEJaW5mbHVlbnphCTIwMDgtMDktMTkJUG9sc2thCUJ5ZGdvc3pjeglIMU4xCTUzLjEyMTk2NDgJMTguMDAwMjUyOQkyMDA4CTkJMTkKRVNJQl9FUUFfMjAyNS5JTkZMMi4wMglpbmZsdWVuemEJMTk4Ny0wNi0xNAlQb2xza2EJT3BvbGUJSDFOMQk1MC42NjY4MTg0CTE3LjkyMzY0MDgJMTk4Nwk2CTE0CkVTSUJfRVFBXzIwMjUuSU5GTDIuMDMJaW5mbHVlbnphCTIwMjMtMTEtMjkJTmllbWN5CUvDtmxuCUgxTjEJNTAuOTM4MzYxCTYuOTU5OTc0CTIwMjMJMTEJMjkKRVNJQl9FUUFfMjAyNS5JTkZMMi4wNAlpbmZsdWVuemEJMTk5My0xMS0yNwlDemVjaHkJUGlsem5vCUgxTjEJNDkuNzQ3NzQxNQkxMy4zNzc1MjQ5CTE5OTMJMTEJMjcKRVNJQl9FUUFfMjAyNS5JTkZMMi4wNQlpbmZsdWVuemEJMjAyMC0xMi0wOAlQb2xza2EJS3Jha8OzdwlIMU4xCTUwLjA2MTk0NzQJMTkuOTM2ODU2NAkyMDIwCTEyCTgKRVNJQl9FUUFfMjAyNS5JTkZMMi4wNglpbmZsdWVuemEJMjAxOC0wMi0xMwlOaWVtY3kJQmVybGluCUgxTjEJNTIuNTE3Mzg4NQkxMy4zOTUxMzA5CTIwMTgJMgkxMwpFU0lCX0VRQV8yMDI1LklORkwyLjA3CWluZmx1ZW56YQkyMDAxLTAzLTAyCVBvbHNrYQlTemN6ZWNpbglIMU4xCTUzLjQzMDE4MTgJMTQuNTUwOTYyMwkyMDAxCTMJMgpFU0lCX0VRQV8yMDI1LklORkwyLjA4CWluZmx1ZW56YQkyMDI0LTA4LTEwCUN6ZWNoeQlCcm5vCUgxTjEJNDkuMTkyMjQ0MwkxNi42MTEzMzgyCTIwMjQJOAkxMApFU0lCX0VRQV8yMDI1LklORkwyLjA5CWluZmx1ZW56YQkyMDEyLTA1LTA2CUN6ZWNoeQlQYXJkdWJpY2UJSDFOMQk1MC4wMzg1ODEyCTE1Ljc3OTEzNTYJMjAxMgk1CTYKRVNJQl9FUUFfMjAyNS5JTkZMMi4xMAlpbmZsdWVuemEJMjAxNi0xMC0yNAlOaWVtY3kJRnJhbmtmdXJ0CUgxTjEJNTAuMTEwNjQ0NAk4LjY4MjA5MTcJMjAxNgkxMAkyNApFU0lCX0VRQV8yMDI1LklORkwyLjExCWluZmx1ZW56YQkyMDIyLTA0LTIxCVBvbHNrYQnFgcOzZMW6CUgxTjEJNTEuNzY4NzMyMwkxOS40NTY5OTExCTIwMjIJNAkyMQpFU0lCX0VRQV8yMDI1LklORkwyLjEyCWluZmx1ZW56YQkyMDE5LTA3LTMwCUN6ZWNoeQlQcmFnYQlIMU4xCTUwLjA4NzQ2NTQJMTQuNDIxMjUzNQkyMDE5CTcJMzAK",
    'test_influenza.json': {
        "output": {
            "input_params_data": {"input_ids" :["ESIB_EQA_2025.INFL2.01",
                                                "ESIB_EQA_2025.INFL2.02",
                                                "ESIB_EQA_2025.INFL2.03",
                                                "ESIB_EQA_2025.INFL2.04",
                                                "ESIB_EQA_2025.INFL2.05",
                                                "ESIB_EQA_2025.INFL2.06",
                                                "ESIB_EQA_2025.INFL2.07",
                                                "ESIB_EQA_2025.INFL2.08",
                                                "ESIB_EQA_2025.INFL2.09",
                                                "ESIB_EQA_2025.INFL2.10",
                                                "ESIB_EQA_2025.INFL2.11",
                                                "ESIB_EQA_2025.INFL2.12"],
                                  "phylogenetic_min_support": 0.75},
            "chronogram_data" : {"chr8_NS": {"clockrate_correlation": 0.11},
                                 "chr2_PB1": {"clockrate_correlation": 0.04},
                                 "chr4_HA" : {"clockrate_correlation": 0.03}},
            "sequence_filtering_data": {
                "chr8_NS": {
                    "ESIB_EQA_2025.INFL2.01" : {"number_of_N": 25 , "number_of_ambiguous": 0, "status": "tak"},
                    "ESIB_EQA_2025.INFL2.10" : {"number_of_N": 25 , "number_of_ambiguous": 0, "status": "tak"}},
                "chr4_HA" : {
                    "ESIB_EQA_2025.INFL2.01": {"number_of_N": 1777, "number_of_ambiguous": 0, "status": "nie"},
                    "ESIB_EQA_2025.INFL2.12": {"number_of_N": 32, "number_of_ambiguous": 0, "status": "tak"}},
                "chr5_NP": {
                    "ESIB_EQA_2025.INFL2.03": {"number_of_N": 25 , "number_of_ambiguous": 0, "status": "tak"},
                    "ESIB_EQA_2025.INFL2.11": {"number_of_N": 32 , "number_of_ambiguous": 0, "status": "tak"}}
            },
            "sequence_clustering_data": {
                "chr7_MP": {"threshold": 1,  "clusters": {"ESIB_EQA_2025.INFL2.01": ["ESIB_EQA_2025.INFL2.01"],
                                                          "ESIB_EQA_2025.INFL2.10": ["ESIB_EQA_2025.INFL2.10"]}},
                "chr1_PB2": {"threshold":1, "clusters": {"ESIB_EQA_2025.INFL2.02": ["ESIB_EQA_2025.INFL2.02"],
                                                         "ESIB_EQA_2025.INFL2.11": ["ESIB_EQA_2025.INFL2.11"]}}
            },
           "filogram_data": {"chr4_HA": { "id_filogram": ["ESIB_EQA_2025.INFL2.02",
                                                          "ESIB_EQA_2025.INFL2.05",
                                                          "ESIB_EQA_2025.INFL2.03",
                                                          "ESIB_EQA_2025.INFL2.04",
                                                          "ESIB_EQA_2025.INFL2.06",
                                                          "ESIB_EQA_2025.INFL2.07",
                                                          "ESIB_EQA_2025.INFL2.08",
                                                          "ESIB_EQA_2025.INFL2.09",
                                                          "ESIB_EQA_2025.INFL2.10",
                                                          "ESIB_EQA_2025.INFL2.11",
                                                          "ESIB_EQA_2025.INFL2.12"],
                                   "program_name": "iqtree2",
                                   "phylogenetic_starting_trees": 10
                                 }
                            }



        }
    },
    "test_salmonella_chronogram.nwk": "((SRR10222053:2.22583,(SRR10235805:0.99227,SRR7890524:0.06809,(SRR10314911:0.66111,SRR10404589:0.66111)NODE_0000003:0.33116)NODE_0000002:1.23356)NODE_0000001:3343.48189,(((SRR5815675:0.58771,SRR5742498:0.52744)NODE_0000006:0.39414,(SRR6029164:0.00000,SRR6107159:0.12603)NODE_0000007:1.33528,(SRR22230307:0.36172,(ERR13711462:2.66496,SRR16216494:0.45400,SRR10236686:2.66496,(SRR29209733:0.38764,SRR23721562:0.14106,SRR27592486:0.08627)NODE_0000010:0.11020)NODE_0000009:0.25567)NODE_0000008:0.03931)NODE_0000005:1148.73118,(SRR28412153:0.36593,SRR2096548:0.39607,SRR7011956:1.34396,SRR3097404:0.61525,SRR5883584:0.47826,SRR14766386:0.36593,SRR8782323:1.58167,SRR8207016:1.64997,SRR6663496:0.99607,(SRR10084881:0.42854,SRR10032843:0.42854,SRR10049737:0.42854,SRR10084868:0.42854)NODE_0000012:2.14288)NODE_0000011:1149.11970)NODE_0000004:2194.01660)NODE_0000000:0.00100;",
    "test_salmonella_filogram.nwk": "(((SRR10235805:1e-06,SRR7890524:1e-06,(SRR10314911:0,SRR10404589:0)100:1e-06)100:1.10493e-06,SRR10222053:1.1129e-06)100:0.00544281,(((SRR5815675:1e-06,SRR5742498:1.41076e-06)97:1e-06,((ERR13711462:1e-06,SRR16216494:1.41076e-06,(SRR29209733:1.49307e-05,SRR23721562:1e-06,SRR27592486:1e-06)100:1e-06,SRR10236686:1e-06)100:1e-06,SRR22230307:1e-06)79:1e-06,(SRR6029164:0,SRR6107159:0)100:1e-06)100:0.00200802,(SRR28412153:1e-06,(SRR10084881:1e-06,SRR10032843:1e-06,(SRR10049737:0,SRR10084868:0)100:1e-06)100:2.69491e-06,SRR2096548:2.23349e-06,SRR7011956:1e-06,SRR3097404:1e-06,SRR5883584:1e-06,SRR14766386:1.12707e-06,SRR8782323:1.42011e-06,SRR8207016:1e-06,SRR6663496:1.66587e-06)100:0.00224506)100:0.00544281);",
    "test_salmonella_microreactproject.microreact": "data:application/octet-stream;base64, c3RyYWluCVNlcm92YXIJTUxTVAljZ01MU1QJSEM1CUhDMTAJcmVnaW9uCWNvdW50cnkJZGl2aXNpb24JY2l0eQlkYXRlCWxhdGl0dWRlCWxvbmdpdHVkZQl5ZWFyCW1vbnRoCWRheQpFUlIxMzcxMTQ2MglFbnRlcml0aWRpcwkxMQkzNjU3ODUJMTM1OAk0MTMJRXVyb3BlCVBvbGFuZAlVTksJT2xzenR5bgkyMDI1LTA0LTAxCTUzLjc3NjY4MzkJMjAuNDc2NTA3CTIwMjUJNAkxClNSUjEwMDMyODQzCUVudGVyaXRpZGlzCTExCTM2NTc4NQkxMzU4CTQxMwlFdXJvcGUJUG9sYW5kCVVOSwlPbHN6dHluCTIwMjUtMDQtMDEJNTMuNzc2NjgzOQkyMC40NzY1MDcJMjAyNQk0CTEKU1JSMTAwNDk3MzcJRW50ZXJpdGlkaXMJMTEJMzY1Nzg1CTEzNTgJNDEzCUV1cm9wZQlQb2xhbmQJVU5LCU9sc3p0eW4JMjAyNS0wNC0wMQk1My43NzY2ODM5CTIwLjQ3NjUwNwkyMDI1CTQJMQpTUlIxMDA4NDg2OAlFbnRlcml0aWRpcwkxMQkzNjU3ODUJMTM1OAk0MTMJRXVyb3BlCVBvbGFuZAlVTksJT2xzenR5bgkyMDI1LTA0LTAxCTUzLjc3NjY4MzkJMjAuNDc2NTA3CTIwMjUJNAkxClNSUjEwMDg0ODgxCUVudGVyaXRpZGlzCTExCTM2NTc4NQkxMzU4CTQxMwlFdXJvcGUJUG9sYW5kCVVOSwlPbHN6dHluCTIwMjUtMDQtMDEJNTMuNzc2NjgzOQkyMC40NzY1MDcJMjAyNQk0CTEKU1JSMTAyMjIwNTMJRW50ZXJpdGlkaXMJMTEJMzY1Nzg1CTEzNTgJNDEzCUV1cm9wZQlQb2xhbmQJVU5LCU9sc3p0eW4JMjAyNS0wNC0wMQk1My43NzY2ODM5CTIwLjQ3NjUwNwkyMDI1CTQJMQpTUlIxMDIzNTgwNQlFbnRlcml0aWRpcwkxMQkzNjU3ODUJMTM1OAk0MTMJRXVyb3BlCVBvbGFuZAlVTksJT2xzenR5bgkyMDI1LTA0LTAxCTUzLjc3NjY4MzkJMjAuNDc2NTA3CTIwMjUJNAkxClNSUjEwMjM2Njg2CUVudGVyaXRpZGlzCTExCTM2NTc4NQkxMzU4CTQxMwlFdXJvcGUJUG9sYW5kCVVOSwlPbHN6dHluCTIwMjUtMDQtMDEJNTMuNzc2NjgzOQkyMC40NzY1MDcJMjAyNQk0CTEKU1JSMTAzMTQ5MTEJRW50ZXJpdGlkaXMJMTEJMzY1Nzg1CTEzNTgJNDEzCUV1cm9wZQlQb2xhbmQJVU5LCU9sc3p0eW4JMjAyNS0wNC0wMQk1My43NzY2ODM5CTIwLjQ3NjUwNwkyMDI1CTQJMQpTUlIxMDQwNDU4OQlFbnRlcml0aWRpcwkxMQkzNjU3ODUJMTM1OAk0MTMJRXVyb3BlCVBvbGFuZAlVTksJT2xzenR5bgkyMDI1LTA0LTAxCTUzLjc3NjY4MzkJMjAuNDc2NTA3CTIwMjUJNAkxClNSUjE0NzY2Mzg2CUVudGVyaXRpZGlzCTExCTM2MjIxMAkxMzU4CTQxMwlFdXJvcGUJUG9sYW5kCVVOSwlLcmFrb3cJMjAyMy0wMS0xNgk1MC4wNjE5NDc0CTE5LjkzNjg1NjQJMjAyMwkxCTE2ClNSUjE2MjE2NDk0CUVudGVyaXRpZGlzCTExCTM2MjE4MQkxMzU4CTQxMwlFdXJvcGUJUG9sYW5kCVVOSwlLcmFrb3cJMjAyMy0wMS0xNAk1MC4wNjE5NDc0CTE5LjkzNjg1NjQJMjAyMwkxCTE0ClNSUjIwOTY1NDgJRW50ZXJpdGlkaXMJMTEJMzYyMTg4CTEzNTgJNDEzCUV1cm9wZQlQb2xhbmQJVU5LCUtyYWtvdwkyMDIzLTAxLTI3CTUwLjA2MTk0NzQJMTkuOTM2ODU2NAkyMDIzCTEJMjcKU1JSMjIyMzAzMDcJRW50ZXJpdGlkaXMJMTEJMzYyMjI1CTEzNTgJNDEzCUV1cm9wZQlQb2xhbmQJVU5LCVJ6ZXN6b3cJMjAyMi0wOS0wOQk1MC4wMzc0NTMxCTIyLjAwNDcxNzQJMjAyMgk5CTkKU1JSMjM3MjE1NjIJRW50ZXJpdGlkaXMJMTEJMjM3NTU4CTEzNTgJNDEzCUV1cm9wZQlQb2xhbmQJVU5LCUJ5ZGdvc3pjegkyMDIyLTExLTAxCTUzLjEyMTk2NDgJMTguMDAwMjUyOQkyMDIyCTExCTEKU1JSMjc1OTI0ODYJRW50ZXJpdGlkaXMJMTEJMzY1NTc2CTEzNTgJNDEzCUV1cm9wZQlQb2xhbmQJVU5LCUthdG93aWNlCTIwMjItMTAtMTIJNTAuMjU5ODk4NwkxOS4wMjE1ODUyCTIwMjIJMTAJMTIKU1JSMjg0MTIxNTMJRW50ZXJpdGlkaXMJMTEJMzY2NTEzCTEzNTgJNDEzCUV1cm9wZQlQb2xhbmQJVU5LCVN6Y3plY2luCTIwMjMtMDEtMTYJNTMuNDMwMTgxOAkxNC41NTA5NjIzCTIwMjMJMQkxNgpTUlIyOTIwOTczMwlFbnRlcml0aWRpcwkxMQkzNjU3ODMJMTM1OAk0MTMJRXVyb3BlCVBvbGFuZAlVTksJQmlhbHlzdG9rCTIwMjMtMDEtMzAJNTMuMTMyMzk4CTIzLjE1OTE2NzkJMjAyMwkxCTMwClNSUjMwOTc0MDQJRW50ZXJpdGlkaXMJMTEJMzYyMjIzCTEzNTgJNDEzCUV1cm9wZQlQb2xhbmQJVU5LCVdyb2NsYXcJMjAyMy0wNC0xNwk1MS4xMDg5Nzc2CTE3LjAzMjY2ODkJMjAyMwk0CTE3ClNSUjU3NDI0OTgJRW50ZXJpdGlkaXMJMTEJMzY2NTMzCTEzNTgJNDEzCUV1cm9wZQlQb2xhbmQJVU5LCUJpYWx5c3RvawkyMDIzLTAzLTE4CTUzLjEzMjM5OAkyMy4xNTkxNjc5CTIwMjMJMwkxOApTUlI1ODE1Njc1CUVudGVyaXRpZGlzCTExCTM2NTc4NQkxMzU4CTQxMwlFdXJvcGUJUG9sYW5kCVVOSwlLYXRvd2ljZQkyMDIzLTA0LTA5CTUwLjI1OTg5ODcJMTkuMDIxNTg1MgkyMDIzCTQJOQpTUlI1ODgzNTg0CUVudGVyaXRpZGlzCTExCTM3MDI1NAkxMzU4CTQxMwlFdXJvcGUJUG9sYW5kCVVOSwlSemVzem93CTIwMjMtMDItMjYJNTAuMDM3NDUzMQkyMi4wMDQ3MTc0CTIwMjMJMgkyNgpTUlI2MDI5MTY0CUVudGVyaXRpZGlzCTExCTUwNzQzNwkxMzU4CTQxMwlFdXJvcGUJUG9sYW5kCVVOSwlLYXRvd2ljZQkyMDIzLTA4LTE2CTUwLjI1OTg5ODcJMTkuMDIxNTg1MgkyMDIzCTgJMTYKU1JSNjEwNzE1OQlFbnRlcml0aWRpcwkxMQk1MDc0NTQJMTM1OAk0MTMJRXVyb3BlCVBvbGFuZAlVTksJS2F0b3dpY2UJMjAyMy0xMC0wMQk1MC4yNTk4OTg3CTE5LjAyMTU4NTIJMjAyMwkxMAkxClNSUjY2NjM0OTYJRW50ZXJpdGlkaXMJMTEJNDAwNTc0CTEzNTgJNDEzCUV1cm9wZQlQb2xhbmQJVU5LCUthdG93aWNlCTIwMjMtMDktMDMJNTAuMjU5ODk4NwkxOS4wMjE1ODUyCTIwMjMJOQkzClNSUjcwMTE5NTYJRW50ZXJpdGlkaXMJMTEJNTA3NTYwCTEzNTgJNDEzCUV1cm9wZQlQb2xhbmQJVU5LCUtyYWtvdwkyMDI0LTAxLTA4CTUwLjA2MTk0NzQJMTkuOTM2ODU2NAkyMDI0CTEJOApTUlI3ODkwNTI0CUVudGVyaXRpZGlzCTExCTUwNzU1MAkxMzU4CTQxMwlFdXJvcGUJUG9sYW5kCVVOSwlHb3J6b3cgV2llbGtvcG9sc2tpCTIwMjQtMDQtMjgJNTIuNzMwOTkyNgkxNS4yNDAwNDUxCTIwMjQJNAkyOApTUlI4MjA3MDE2CUVudGVyaXRpZGlzCTExCTUwNzU4NAkxMzU4CTQxMwlFdXJvcGUJUG9sYW5kCVVOSwlHb3J6b3cgV2llbGtvcG9sc2tpCTIwMjQtMDQtMjkJNTIuNzMwOTkyNgkxNS4yNDAwNDUxCTIwMjQJNAkyOQpTUlI4NzgyMzIzCUVudGVyaXRpZGlzCTExCTUwNzcwOQkxMzU4CTQxMwlFdXJvcGUJUG9sYW5kCVVOSwlLaWVsY2UJMjAyNC0wNC0wNAk1MC44NzE5OTAzCTIwLjYzMTA0ODgJMjAyNAk0CTQK",
    "test_salmonella.json" : {
        "output": {
            "input_params_data": {
                    "input_ids": [
                    "ERR13711462",
                    "SRR10032843",
                    "SRR10049737",
                    "SRR10084868",
                    "SRR10084881",
                    "SRR10222053",
                    "SRR10235805",
                    "SRR10236686",
                    "SRR10314911",
                    "SRR10404589",
                    "SRR14766386",
                    "SRR16216494",
                    "SRR2096548",
                    "SRR22230307",
                    "SRR23721562",
                    "SRR27592486",
                    "SRR28412153",
                    "SRR29209733",
                    "SRR3097404",
                    "SRR5742498",
                    "SRR5815675",
                    "SRR5883584",
                    "SRR6029164",
                    "SRR6107159",
                    "SRR6663496",
                    "SRR7011956",
                    "SRR7890524",
                    "SRR8207016",
                    "SRR8782323"
                ],
                "phylogenetic_min_support": 70
            },
            "chronogram_data": {"bacterial_genome": {
                "clockrate_correlation": 0.11
            }
            },
            "sequence_filtering_data": {
                "bacterial_genome": {
                    "ERR13711462": {"number_of_N": 0, "number_of_ambiguous": 0, "status": "tak", },
                    "SRR29209733": {"number_of_N": 42, "number_of_ambiguous": 0, "status": "tak", },
                    "SRR8782323": {"number_of_N": 0, "number_of_ambiguous": 0, "status": "tak", },
                    "SRR7890524": {"number_of_N": 0, "number_of_ambiguous": 0, "status": "tak"}
                }
            },
            "sequence_clustering_data": {
                "bacterial_genome": {"threshold": 1.0, "clusters": {"SRR10049737": ["SRR10049737", "SRR10084868"],
                                                                    "SRR10314911": ["SRR10314911", "SRR10404589"],
                                                                    "SRR10084881": ["SRR10084881"]

                                                              }
                               }
            },
            "filogram_data": {"bacterial_genome": {"id_filogram": [
                                                                    "ERR13711462",
                                                                    "SRR10032843",
                                                                    "SRR10049737",
                                                                    "SRR10084881",
                                                                    "SRR10222053",
                                                                    "SRR10235805",
                                                                    "SRR10236686",
                                                                    "SRR10314911",
                                                                    "SRR14766386",
                                                                    "SRR16216494",
                                                                    "SRR2096548",
                                                                    "SRR22230307",
                                                                    "SRR23721562",
                                                                    "SRR27592486",
                                                                    "SRR28412153",
                                                                    "SRR29209733",
                                                                    "SRR3097404",
                                                                    "SRR5742498",
                                                                    "SRR5815675",
                                                                    "SRR5883584",
                                                                    "SRR6029164",
                                                                    "SRR6663496",
                                                                    "SRR7011956",
                                                                    "SRR7890524",
                                                                    "SRR8207016",
                                                                    "SRR8782323"
                                                                ],
                                             "program_name": "raxml-ng",
                                             "phylogenetic_starting_trees": 10
                                             }
                              }
        }
    },
    "test_rsv_hRSV_A_England_397_2017_chronogram.nwk": "(EPI_ISL_19693732:8.45093,(((EPI_ISL_19689070:0.41814,EPI_ISL_19693745:0.45102)NODE_0000008:5.07331,(EPI_ISL_19725090:4.84024,EPI_ISL_19725390:4.83202)NODE_0000009:0.65943)NODE_0000007:2.82892,(((EPI_ISL_19685832:0.21900,EPI_ISL_19689072:0.19982)NODE_0000000:4.65508,(EPI_ISL_19693744:1.28777,EPI_ISL_19709602:1.29873)NODE_0000002:3.58631)NODE_0000001:0.40337,(EPI_ISL_19693731:4.23879,EPI_ISL_19693743:4.24701,EPI_ISL_19725092:4.23057,(EPI_ISL_19687298:1.07363,EPI_ISL_19693741:1.09554)NODE_0000005:3.15694)NODE_0000004:1.03045)NODE_0000003:3.06484)NODE_0000006:0.10316)NODE_0000010:0.00100;",
    "test_rsv_hRSV_A_England_397_2017_filogram.nwk": "(EPI_ISL_19685832:0.000134699,EPI_ISL_19689072:0.00039865,((((EPI_ISL_19687298:0.00148572,EPI_ISL_19693741:0.00127555)100:0.00435953,EPI_ISL_19693731:0.00497537,EPI_ISL_19693743:0.00533492,EPI_ISL_19725092:0.0065391)100:0.000725276,(EPI_ISL_19693732:0.0102092,((EPI_ISL_19689070:0.000415975,EPI_ISL_19693745:0.000638576)100:0.00563062,(EPI_ISL_19725090:0.00567095,EPI_ISL_19725390:0.00615124)99:0.000896515)100:0.00335843)100:0.00327704)91:0.000329312,(EPI_ISL_19693744:0.00190213,EPI_ISL_19709602:0.00126071)100:0.00422824)100:0.00637982);",
    "test_rsv_hRSV_A_England_397_2017_microreactproject.microreact": "data:application/octet-stream;base64, c3RyYWluCWNvdW50cnkJY2l0eQlkYXRlCXZpcnVzCXR5cGUJbGF0aXR1ZGUJbG9uZ2l0dWRlCXllYXIJbW9udGgJZGF5CkVQSV9JU0xfMTk2ODU4MzIJU3BhaW4JQmFyY2Vsb25hCTIwMjUtMDEtMTIJUlNWCUEJNDEuMzgyNTgwMgkyLjE3NzA3MwkyMDI1CTEJMTIKRVBJX0lTTF8xOTY4NTgzMwlTcGFpbglCYXJjZWxvbmEJMjAyNS0wMS0xMQlSU1YJQQk0MS4zODI1ODAyCTIuMTc3MDczCTIwMjUJMQkxMQpFUElfSVNMXzE5Njg1ODM2CVNwYWluCUJhcmNlbG9uYQkyMDI1LTAxLTA2CVJTVglBCTQxLjM4MjU4MDIJMi4xNzcwNzMJMjAyNQkxCTYKRVBJX0lTTF8xOTY4NzI5NglTcGFpbglCYXJjZWxvbmEJMjAyNS0wMS0wMwlSU1YJQQk0MS4zODI1ODAyCTIuMTc3MDczCTIwMjUJMQkzCkVQSV9JU0xfMTk2ODcyOTcJU3BhaW4JQmFyY2Vsb25hCTIwMjUtMDEtMDMJUlNWCUEJNDEuMzgyNTgwMgkyLjE3NzA3MwkyMDI1CTEJMwpFUElfSVNMXzE5Njg3Mjk4CVNwYWluCUJhcmNlbG9uYQkyMDI1LTAxLTA2CVJTVglBCTQxLjM4MjU4MDIJMi4xNzcwNzMJMjAyNQkxCTYKRVBJX0lTTF8xOTY4NzI5OQlTcGFpbglCYXJjZWxvbmEJMjAyNS0wMS0wNglSU1YJQQk0MS4zODI1ODAyCTIuMTc3MDczCTIwMjUJMQk2CkVQSV9JU0xfMTk2ODkwNzAJU3BhaW4JQmFyY2Vsb25hCTIwMjUtMDEtMDQJUlNWCUEJNDEuMzgyNTgwMgkyLjE3NzA3MwkyMDI1CTEJNApFUElfSVNMXzE5Njg5MDcyCVNwYWluCUJhcmNlbG9uYQkyMDI1LTAxLTA1CVJTVglBCTQxLjM4MjU4MDIJMi4xNzcwNzMJMjAyNQkxCTUKRVBJX0lTTF8xOTY5MzczMQlTcGFpbglCYXJjZWxvbmEJMjAyNS0wMS0wOQlSU1YJQQk0MS4zODI1ODAyCTIuMTc3MDczCTIwMjUJMQk5CkVQSV9JU0xfMTk2OTM3MzIJU3BhaW4JQmFyY2Vsb25hCTIwMjUtMDEtMTQJUlNWCUEJNDEuMzgyNTgwMgkyLjE3NzA3MwkyMDI1CTEJMTQKRVBJX0lTTF8xOTY5Mzc0MQlTcGFpbglCYXJjZWxvbmEJMjAyNS0wMS0xNAlSU1YJQQk0MS4zODI1ODAyCTIuMTc3MDczCTIwMjUJMQkxNApFUElfSVNMXzE5NjkzNzQzCVNwYWluCUJhcmNlbG9uYQkyMDI1LTAxLTEyCVJTVglBCTQxLjM4MjU4MDIJMi4xNzcwNzMJMjAyNQkxCTEyCkVQSV9JU0xfMTk2OTM3NDQJU3BhaW4JQmFyY2Vsb25hCTIwMjUtMDEtMTIJUlNWCUEJNDEuMzgyNTgwMgkyLjE3NzA3MwkyMDI1CTEJMTIKRVBJX0lTTF8xOTY5Mzc0NQlTcGFpbglCYXJjZWxvbmEJMjAyNS0wMS0xNglSU1YJQQk0MS4zODI1ODAyCTIuMTc3MDczCTIwMjUJMQkxNgpFUElfSVNMXzE5NzA5NjAyCVNwYWluCUJhcmNlbG9uYQkyMDI1LTAxLTE2CVJTVglBCTQxLjM4MjU4MDIJMi4xNzcwNzMJMjAyNQkxCTE2CkVQSV9JU0xfMTk3MjUwOTAJSXJlbGFuZAlEdWJsaW4JMjAyNS0wMS0wNwlSU1YJQQk1My4zNDkzNzk1CS02LjI2MDU1OTMJMjAyNQkxCTcKRVBJX0lTTF8xOTcyNTA5MglJcmVsYW5kCUR1YmxpbgkyMDI1LTAxLTA2CVJTVglBCTUzLjM0OTM3OTUJLTYuMjYwNTU5MwkyMDI1CTEJNgpFUElfSVNMXzE5NzI1MzkwCVNwYWluCU1hZHJpZAkyMDI1LTAxLTA0CVJTVglBCTQwLjQxNjc4MgktMy43MDM1MDcJMjAyNQkxCTQK",
    'test_rsv.json': {
        "output": {
            "input_params_data": {
                "input_ids": [
                    "EPI_ISL_19685832",
                    "EPI_ISL_19685833",
                    "EPI_ISL_19685836",
                    "EPI_ISL_19687296",
                    "EPI_ISL_19687297",
                    "EPI_ISL_19687298",
                    "EPI_ISL_19687299",
                    "EPI_ISL_19689070",
                    "EPI_ISL_19689072",
                    "EPI_ISL_19693731",
                    "EPI_ISL_19693732",
                    "EPI_ISL_19693741",
                    "EPI_ISL_19693743",
                    "EPI_ISL_19693744",
                    "EPI_ISL_19693745",
                    "EPI_ISL_19709602",
                    "EPI_ISL_19725090",
                    "EPI_ISL_19725092",
                    "EPI_ISL_19725390"
                ],
                "phylogenetic_min_support": 0.75
            },
            "chronogram_data": {"hRSV_A_England_397_2017": {
                "clockrate_correlation": 0.06
            }
            },
            "sequence_filtering_data": {
                "hRSV_A_England_397_2017": {
                    "EPI_ISL_19685832": {"number_of_N": 76, "number_of_ambiguous": 0, "status": "tak", },
                    "EPI_ISL_19685833": {"number_of_N": 581, "number_of_ambiguous": 0, "status": "nie", },
                    "EPI_ISL_19689072": {"number_of_N": 0, "number_of_ambiguous": 0, "status": "tak", },
                    "EPI_ISL_19725092": {"number_of_N": 12, "number_of_ambiguous": 0, "status": "tak"}
                }
            },
            "sequence_clustering_data": {
                "hRSV_A_England_397_2017": {"threshold": 1.0, "clusters": {"EPI_ISL_19689072": ["EPI_ISL_19689072"],
                                                              "EPI_ISL_19693744": ["EPI_ISL_19693744"]
                                                              }
                               }
            },
            "filogram_data": {"hRSV_A_England_397_2017": {"id_filogram": [
                                                                            "EPI_ISL_19685832",
                                                                            "EPI_ISL_19689072",
                                                                            "EPI_ISL_19687298",
                                                                            "EPI_ISL_19693741",
                                                                            "EPI_ISL_19693731",
                                                                            "EPI_ISL_19693743",
                                                                            "EPI_ISL_19725092",
                                                                            "EPI_ISL_19693744",
                                                                            "EPI_ISL_19709602",
                                                                            "EPI_ISL_19693732",
                                                                            "EPI_ISL_19689070",
                                                                            "EPI_ISL_19693745",
                                                                            "EPI_ISL_19725090",
                                                                            "EPI_ISL_19725390"
                                                                        ],
                                             "program_name": "iqtree2",
                                             "phylogenetic_starting_trees": 10
                                             }
                              }
        }
    }

}


def load_json_content(json_path: Path):
    with open(json_path, 'r') as f:
        return json.load(f)


def test_check_json_validity(json_file, request):

    # read json
    content = load_json_content(json_file)

    # read schema from repo
    validate = _load_schema_validator(request.config.getoption("schema"))

    # evaluate content against schema
    try:
        validate(content)
        assert True == True
    except Exception as e:
        assert False == True,  f"{json_file.name}: {e}"


def test_directory_existence(json_file):
    content = load_json_content(json_file)
    results_dir = content.get('output', {}).get("input_params_data", {}).get("results_dir", "") or ""
    exec_dir = content.get('output', {}).get("ExecutionDir_dir", "") or ""
    print(results_dir)
    if not results_dir:
        assert False, f"{json_file.name}: no results dir found"
    if not exec_dir:
        assert False, f"{json_file.name}: no execution dir found"

    assert True


@pytest.mark.parametrize("json_field",
                         ["filogram_nwk",
                          "chronogram_nwk",
                          "microreact_json"
                          ])
def test_files_exist(json_file, json_field):
    status = True
    content = load_json_content(json_file)
    exec_dir = content.get('output', {}).get("ExecutionDir_dir", "") or ""

    files_dict = content.get("output", {}).get(json_field, {}) or {}
    if len(files_dict) == 0:
        assert False, f"{json_file.name}: no data found for {json_field}"

    segment = None
    for segment, path in files_dict.items():
        segment_file = Path(exec_dir) / f"{path}"
        if not os.path.isfile(segment_file):
            status = False
            break

    if status:
        assert True
    else:
        assert False, f"{json_file.name}: no {json_field} file found for segment {segment}"


@pytest.mark.parametrize("json_field",
                         ["input_ids",
                          "phylogenetic_min_support",
                          ])
def test_input_param_ids(json_file, json_field):

    content = load_json_content(json_file)
    observed = content["output"]["input_params_data"][json_field]
    expected = GOLDENS[json_file.name]["output"]["input_params_data"][json_field]

    if isinstance(observed, list):
        assert set(observed) == set(expected), f"{json_file.name}: input params mismatch for field {json_field}"
    else:
        assert observed == expected, f"{json_file.name}: input params mismatch for field: {json_field}"


@pytest.mark.parametrize("json_field",
                         ["clockrate_correlation"
                          ])
def test_chronogram_data(json_file, json_field):

    content = load_json_content(json_file)
    list_of_segments = GOLDENS[json_file.name]["output"]["chronogram_data"].keys()
    for segment in list_of_segments:
        observed = content["output"]["chronogram_data"][segment][json_field]
        expected =  GOLDENS[json_file.name]["output"]["chronogram_data"][segment][json_field]
    assert expected == observed, f"{json_file.name}: chronogram data mismatch for field: {json_field}"


@pytest.mark.parametrize("json_field",
                         ["number_of_N",
                          "number_of_ambiguous",
                          "status"
                          ])
def test_sequence_filtering_data(json_file, json_field):

    content = load_json_content(json_file)

    list_of_segments = GOLDENS[json_file.name]["output"]["sequence_filtering_data"].keys()
    for segment in list_of_segments:
        list_of_samples = GOLDENS[json_file.name]["output"]["sequence_filtering_data"][segment].keys()
        for sample in list_of_samples:
            observed = content["output"]["sequence_filtering_data"][segment][sample][json_field]
            expected =  GOLDENS[json_file.name]["output"]["sequence_filtering_data"][segment][sample][json_field]
            assert expected == observed, f"{json_file.name}: {json_field} mismatch in filtering data for sample {sample}"



def test_sequence_clustering_data(json_file):

    content = load_json_content(json_file)
    list_of_segments = GOLDENS[json_file.name]["output"]["sequence_clustering_data"].keys()
    for segment in list_of_segments:
        list_of_samples = GOLDENS[json_file.name]["output"]["sequence_clustering_data"][segment]["clusters"].keys()
        for sample in list_of_samples:
            observed = set(content["output"]["sequence_clustering_data"][segment]["clusters"][sample])
            expected =  set(GOLDENS[json_file.name]["output"]["sequence_clustering_data"][segment]["clusters"][sample])

            assert observed == expected,  f"{json_file.name} mismatch in clustering data for segment: {segment} for sample: {sample}"


@pytest.mark.parametrize("json_field",
                         ["program_name",
                          "phylogenetic_starting_trees"
                          ])
def test_filogram_data(json_file, json_field):

    content = load_json_content(json_file)
    list_of_segments = GOLDENS[json_file.name]["output"]["filogram_data"].keys()
    for segment in list_of_segments:
        observed = content["output"]["filogram_data"][segment][json_field]
        expected =  GOLDENS[json_file.name]["output"]["filogram_data"][segment][json_field]

        if isinstance(observed, list):
            observed = set(observed)
            expected = set(expected)

        assert observed == expected,  f"{json_file.name} mismatch in filogram_data for segment: {segment} for field {json_field}"


def test_tree_topology(tree_file):
    # We allow 1 different split in trees
    expected = Tree(GOLDENS[tree_file.name], format=1)
    # observed = Tree(open(tree_file, "r").readline(), format=1)
    observed = Tree(Path(tree_file).read_text(encoding="utf-8"), format=1)


    rf, rf_max, *_ = expected.robinson_foulds(observed, unrooted_trees=True)
    assert rf <= 1, f"{tree_file.name} mismatch with expected tree"


def test_microreact_blob(microreact_file):
    content = load_json_content(microreact_file)

    expected = GOLDENS[microreact_file.name]
    observed =  content["files"]["sib4"]["blob"]


    assert observed == expected, f"Error in blo blob csv in microreact file {microreact_file.name}"